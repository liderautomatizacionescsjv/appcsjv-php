{"version":3,"sources":["script.js"],"names":["estudiante_sel","codigo","fecha","grupo","reporte","hoy","Date","toISOString","split","estudiante_global","grupos_global","reportes_global","estadoGrupos","menu","menuIcon","document","querySelector","menuDeslizante","menuCerrar","menuOverlay","addEventListener","classList","add","remove","async","cargarEstadoGrupos","respuesta","fetch","json","console","log","error","iniciarApp","consultarApi","consultarReportes","cargarAsignaciones","verificarEstadoGrupo","url","asignaciones","selectGrupos","getElementById","selectAsignaturas","innerHTML","forEach","asignacion","nombre_grupo","opcionGrupo","createElement","value","grupoid","textContent","appendChild","nombre_asignatura","opcionAsignatura","cursoid","resultado","mostrarEstudiantes","filtrarEstudiantes","mostrarReportes","mostrarGrupos","grupos","nombre","id","nombreGrupo","registros","tabla","sort","a","b","fechahora","registro","estudiante","comentario","responsable","codigoid","fila","r_estudiante","r_reporte","r_comentario","r_responsable","r_asignatura","r_fecha","r_grupo","r_acciones","botonEliminar","onclick","eliminarReporte","estudiantes","documento","fechaNacimiento","estado","nombreEstudiante","estadoEstudiante","botonFalta","event","stopPropagation","registrarNovedad","botonTarde","botonExcusa","ficha","dataset","idFicha","removerSeleccion","verEstudiante","acciones","info","mostrarNotificacion","mensaje","contenedor","notificacion","setTimeout","grupoSeleccionado","estudiantesFiltrados","filter","est","filtrarReportesPorEstudiante","codigoEstudiante","reportesFiltrados","String","filtrarTabla","columna","filtro","querySelectorAll","toUpperCase","filas","getElementsByTagName","i","length","celda","textoCelda","innerText","style","display","indexOf","info_nombre","info_codigo","info_documento","info_fechaNacimiento","info_grado","iniciarCalendario","calendarEl","FullCalendar","Calendar","initialView","locale","events","render","abrirModalReserva","cerrarModalReserva","asignaturaSeleccionada","datos","FormData","append","method","body","confirm","formData","ok","Error","warn","grupoId","botonGrupoCompleto","find","g","idgrupo","completo","disabled","alert","fechaActual","exito"],"mappings":"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","file":"bundle.js","sourcesContent":["// VARIABLES\n\nconst estudiante_sel = {\n    codigo: '',\n    fecha: '',\n    grupo: '',\n    reporte: ''\n}\n\nconst hoy = new Date().toISOString().split('T')[0];\n\nlet estudiante_global = []\nlet grupos_global = []\nlet reportes_global = []\nlet estadoGrupos = []; // Variable para almacenar el estado de los grupos\n\n\n// DOM\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    iniciarApp();\n    cargarEstadoGrupos(); // Cargaar el estado de los grupos al inicio\n    menu();\n    iniciarCalendario();\n\n    \n});\n\nfunction menu(){\n    const menuIcon = document.querySelector(\".menu-icon\");\n    const menuDeslizante = document.querySelector(\".menu-deslizante\");\n    const menuCerrar = document.querySelector(\".menu-cerrar\");\n    const menuOverlay = document.querySelector(\".menu-overlay\");\n\n    // Abrir el men√∫\n    menuIcon.addEventListener(\"click\", () => {\n        menuDeslizante.classList.add(\"menu-abierto\");\n        menuOverlay.classList.add(\"activo\");\n    });\n\n    // Cerrar el men√∫ con el bot√≥n ‚úñ\n    menuCerrar.addEventListener(\"click\", () => {\n        menuDeslizante.classList.remove(\"menu-abierto\");\n        menuOverlay.classList.remove(\"activo\");\n    });\n\n    // Cerrar el men√∫ al hacer clic fuera de √©l\n    menuOverlay.addEventListener(\"click\", () => {\n        menuDeslizante.classList.remove(\"menu-abierto\");\n        menuOverlay.classList.remove(\"activo\");\n    });\n}\n\n\nasync function cargarEstadoGrupos() {\n    try {\n        const respuesta = await fetch(\"http://localhost:3002/api/estado-grupos\");\n        estadoGrupos = await respuesta.json(); // Guardar el estado de los grupos\n        console.log(\"Estado de los grupos:\", estadoGrupos);\n    } catch (error) {\n        console.error(\"Error al cargar el estado de los grupos:\", error);\n    }\n}\n\nfunction iniciarApp(){\n    // consultarGrupos();\n    consultarApi();\n    consultarReportes();\n    cargarAsignaciones();\n    verificarEstadoGrupo(); // Verificar el estado del grupo seleccionado\n\n}\n\n\n\n// CONSULTAS\n\n// async function consultarGrupos(){\n//     try {\n//         const url = 'http://localhost:3002/api/grupos';\n//         const resultado = await fetch(url);\n//         grupos_global = await resultado.json();\n\n//         mostrarGrupos(grupos_global);\n\n//     } catch (error) {\n//         console.log(error);\n//     }\n// }\n\nasync function cargarAsignaciones() {\n    try {\n        const url = 'http://localhost:3002/api/asignaciones';\n        const respuesta = await fetch(url);\n        const asignaciones = await respuesta.json();\n\n        // console.log(\"Asignaciones recibidas:\", asignaciones);\n\n        // Seleccionar los elementos del DOM\n        const selectGrupos = document.getElementById(\"grupos\");\n        const selectAsignaturas = document.getElementById(\"asignatura\");\n\n        if (!selectGrupos || !selectAsignaturas) {\n            console.error(\"Error: No se encontraron los elementos select en el DOM.\");\n            return;\n        }\n\n        // Limpiar los selectores antes de agregar opciones\n        selectGrupos.innerHTML = `<option value=\"\">--Seleccione--</option>`;\n        selectAsignaturas.innerHTML = `<option value=\"\">--Seleccione--</option>`;\n\n        // Llenar los selectores con los datos recibidos de la API\n        asignaciones.forEach(asignacion => {\n            if (asignacion.nombre_grupo) {\n                const opcionGrupo = document.createElement(\"option\");\n                opcionGrupo.value = asignacion.grupoid;\n                opcionGrupo.textContent = asignacion.nombre_grupo;\n                selectGrupos.appendChild(opcionGrupo);\n            }\n\n            if (asignacion.nombre_asignatura) {\n                const opcionAsignatura = document.createElement(\"option\");\n                opcionAsignatura.value = asignacion.cursoid;\n                opcionAsignatura.textContent = asignacion.nombre_asignatura;\n                selectAsignaturas.appendChild(opcionAsignatura);\n            }\n        });\n\n        // console.log(\"Opciones de grupos agregadas:\", selectGrupos.innerHTML);\n        // console.log(\"Opciones de asignaturas agregadas:\", selectAsignaturas.innerHTML);\n\n    } catch (error) {\n        console.error(\"Error al cargar asignaciones:\", error);\n    }\n}\n\n\n\n\n\n\nasync function consultarApi(){\n    try {\n        const url = 'http://localhost:3002/api/estudiantes';\n        const resultado = await fetch(url);\n        estudiante_global = await resultado.json();\n\n        mostrarEstudiantes(estudiante_global);\n\n        document.getElementById(\"grupos\").addEventListener(\"change\", filtrarEstudiantes);\n\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nasync function consultarReportes(){\n    try {\n        const url = 'http://localhost:3002/api/reporte';\n        const resultado = await fetch(url);\n        reportes_global = await resultado.json();\n\n        mostrarReportes(reportes_global);\n\n        // document.getElementById(\"grupos\").addEventListener(\"change\", filtrarEstudiantes);\n\n    } catch (error) {\n        console.log(error);\n    }\n}\n\n\n// FUNCIONES DE MUESTRA\n\n\nfunction mostrarGrupos(grupos){\n    grupos.forEach(grupo => {\n        const {nombre, id} = grupo\n\n        const nombreGrupo = document.createElement('OPTION');\n        nombreGrupo.textContent = nombre;\n        nombreGrupo.value = id;\n\n        document.querySelector('#grupos').appendChild(nombreGrupo)\n    })\n}\n\n\nfunction mostrarReportes(registros) {\n    const tabla = document.getElementById('filas'); // Seleccionar el tbody donde agregar las filas\n    tabla.innerHTML = \"\"; // Limpiar la tabla antes de agregar nuevos reportes\n\n    // Ordenar registros por fecha (descendente)\n    registros.sort((a, b) => new Date(b.fechahora) - new Date(a.fechahora));\n\n    registros.forEach(registro => {\n        const { estudiante, reporte, comentario, responsable, nombre_asignatura, fechahora, nombre_grupo, codigoid } = registro;\n\n        // Crear una nueva fila para el reporte\n        const fila = document.createElement('tr');\n\n        // Crear celdas para cada dato\n        const r_estudiante = document.createElement('td');\n        r_estudiante.textContent = estudiante;\n\n        const r_reporte = document.createElement('td');\n        r_reporte.textContent = reporte;\n\n        const r_comentario = document.createElement('td');\n        r_comentario.textContent = comentario;\n\n        const r_responsable = document.createElement('td');\n        r_responsable.textContent = responsable;\n\n        const r_asignatura = document.createElement('td');\n        r_asignatura.textContent = nombre_asignatura;\n\n\n        const r_fecha = document.createElement('td');\n        r_fecha.textContent = fechahora; // Mantener el formato original\n\n        const r_grupo = document.createElement('td');\n        r_grupo.textContent = nombre_grupo;\n\n\n        const r_codigo = document.createElement('td');\n        r_codigo.textContent = codigoid;\n\n        // Crear celda para acciones (ejemplo de un bot√≥n)\n        const r_acciones = document.createElement('td');\n        const botonEliminar = document.createElement('button');\n        botonEliminar.textContent = \"Eliminar\";\n        botonEliminar.classList.add(\"btn-eliminar\");\n        botonEliminar.onclick = () => eliminarReporte(registro.id);\n        r_acciones.appendChild(botonEliminar);\n\n        // Agregar todas las celdas a la fila\n        fila.appendChild(r_estudiante);\n        fila.appendChild(r_reporte);\n        fila.appendChild(r_comentario);\n        fila.appendChild(r_responsable);\n        fila.appendChild(r_asignatura);\n        fila.appendChild(r_fecha);\n        fila.appendChild(r_grupo);\n        fila.appendChild(r_acciones);\n\n        // Agregar la fila a la tabla\n        tabla.appendChild(fila);\n    });\n}\n\n\n\n\nfunction mostrarEstudiantes(estudiantes) {\n    estudiantes.forEach(estudiante => {\n        const { codigo, documento, fechaNacimiento, grupoid, nombre, estado, fecha} = estudiante;\n\n        const nombreEstudiante = document.createElement('H4');\n        nombreEstudiante.classList.add('nombre-estudiante');\n        nombreEstudiante.textContent = nombre;\n\n        const estadoEstudiante = document.createElement('P');\n        estadoEstudiante.classList.add('estado-estudiante');\n        estadoEstudiante.textContent =  estado ? estado : '';\n        // Validar si hay estado y la fecha coincide con la actual\n        if (estado && fecha === hoy) {\n            estadoEstudiante.textContent = estado;\n            estadoEstudiante.classList.remove('oculto'); \n        } else {\n            estadoEstudiante.textContent = ''; \n            estadoEstudiante.classList.add('oculto');\n        }\n\n        // Crear los botones con stopPropagation()\n        const botonFalta = document.createElement('BUTTON');\n        botonFalta.classList.add('boton');\n        botonFalta.textContent = 'Falta';\n        botonFalta.onclick = function (event) {\n            event.stopPropagation(); // Evita que el clic en el bot√≥n active la selecci√≥n de la ficha\n            registrarNovedad(estudiante, 'falta');\n        };\n\n        const botonTarde = document.createElement('BUTTON');\n        botonTarde.classList.add('boton');\n        botonTarde.textContent = 'Tarde';\n        botonTarde.onclick = function (event) {\n            event.stopPropagation();\n            registrarNovedad(estudiante, 'tarde');\n        };\n\n        const botonExcusa = document.createElement('BUTTON');\n        botonExcusa.classList.add('boton');\n        botonExcusa.textContent = 'Excusa';\n        botonExcusa.onclick = function (event) {\n            event.stopPropagation();\n            registrarNovedad(estudiante, 'excusa');\n        };\n\n        const ficha = document.createElement('DIV');\n        ficha.classList.add('ficha');\n        ficha.dataset.idFicha = codigo;\n\n        ficha.onclick = function () {\n            removerSeleccion();\n            ficha.classList.add('seleccionado');\n            verEstudiante(nombre, codigo, documento, fechaNacimiento, grupoid);\n        };\n\n        const acciones = document.createElement('DIV');\n        acciones.classList.add('acciones');\n\n        acciones.appendChild(botonFalta);\n        acciones.appendChild(botonTarde);\n        acciones.appendChild(botonExcusa);\n\n        const info = document.createElement('DIV');\n        info.classList.add('info');\n\n        info.appendChild(nombreEstudiante)\n        info.appendChild(estadoEstudiante)\n\n\n        ficha.appendChild(info);\n\n        ficha.appendChild(acciones);\n\n        document.querySelector('#fichas').appendChild(ficha);\n    });\n}\n\nfunction mostrarNotificacion(mensaje) {\n    const contenedor = document.getElementById(\"notificacion-container\");\n\n    // Crear la notificaci√≥n\n    const notificacion = document.createElement(\"div\");\n    notificacion.classList.add(\"notificacion\");\n\n    // Agregar contenido con √≠cono y texto\n    notificacion.innerHTML = `<i>‚úÖ</i> ${mensaje}`;\n\n    // Agregar la notificaci√≥n al contenedor\n    contenedor.appendChild(notificacion);\n\n    // Eliminar la notificaci√≥n despu√©s de 4 segundos\n    setTimeout(() => {\n        notificacion.remove();\n    }, 4000);\n}\n\n\n\n\n// ----------------------- FILTROS --------------------\n\n\n\nfunction filtrarEstudiantes() {\n    const grupoSeleccionado = document.getElementById(\"grupos\").value; // Obtener el grupo seleccionado\n\n    console.log(grupoSeleccionado)\n    // Filtrar estudiantes solo si se selecciona un grupo\n    let estudiantesFiltrados = grupoSeleccionado\n        ? estudiante_global.filter(est => est.grupoid === grupoSeleccionado)\n        : estudiante_global; // Si no hay selecci√≥n, mostrar todos\n\n    // Limpiar el contenedor antes de agregar los nuevos resultados\n    document.querySelector(\"#fichas\").innerHTML = \"\";\n\n    // Mostrar los estudiantes filtrados\n    mostrarEstudiantes(estudiantesFiltrados);\n}\n\n\n\n\nfunction filtrarReportesPorEstudiante(codigoEstudiante) {\n    console.log(\"C√≥digo seleccionado:\", codigoEstudiante);\n    console.log(\"Lista de reportes:\", reportes_global);\n\n    let reportesFiltrados = reportes_global.filter(reporte => String(reporte.codigoid) === String(codigoEstudiante));\n\n    console.log(\"Reportes filtrados:\", reportesFiltrados); // Esto nos dir√° si hay coincidencias\n\n    mostrarReportes(reportesFiltrados);\n}\n\nfunction filtrarTabla(columna) {\n    // Obtener el valor del input\n    const input = document.querySelectorAll(\"thead input\")[columna];\n    const filtro = input.value.toUpperCase();\n    const tabla = document.getElementById(\"miTabla\");\n    const filas = tabla.getElementsByTagName(\"tr\");\n    \n    // Iterar sobre las filas del cuerpo de la tabla\n    for (let i = 1; i < filas.length; i++) {\n      const celda = filas[i].getElementsByTagName(\"td\")[columna];\n      if (celda) {\n        const textoCelda = celda.textContent || celda.innerText;\n        filas[i].style.display = textoCelda.toUpperCase().indexOf(filtro) > -1 ? \"\" : \"none\";\n      }\n    }\n  }\n\n\n\n// ------------------------ FUNCIONALIDADES ------------------\n\n\nfunction removerSeleccion() {\n    const fichas = document.querySelectorAll('.ficha.seleccionado');\n    fichas.forEach(ficha => ficha.classList.remove('seleccionado'));\n}\n\n\nfunction verEstudiante(nombre, codigo, documento, fechaNacimiento, grupoid){\n    \n    let info_nombre = document.getElementById('info_nombre');\n    let info_codigo = document.getElementById('info_codigo');\n    let info_documento = document.getElementById('info_documento');\n    let info_fechaNacimiento = document.getElementById('info_fechaNacimiento');\n    let info_grado = document.getElementById('info_grado');\n\n\n    info_nombre.innerHTML = `<strong>Nombre: </strong>${nombre}`;\n    info_codigo.innerHTML = `<strong>C√≥digo: </strong>${codigo}`;\n    info_documento.innerHTML = `<strong>Documento: </strong>${documento}`;\n    info_fechaNacimiento.innerHTML = `<strong>Fecha de Nacimiento: </strong>${fechaNacimiento}`;\n    info_grado.innerHTML = `<strong>Grado: </strong>${grupoid}`;\n\n\n    // ACTUALIZAR estudiante_sel con el c√≥digo del estudiante seleccionado\n    estudiante_sel.codigo = codigo;\n\n    // console.log(\"C√≥digo del estudiante seleccionado:\", codigo);\n    // console.log(\"Valor actualizado en estudiante_sel:\", estudiante_sel.codigo);\n    // Filtrar la tabla de reportes seg√∫n el estudiante seleccionado\n    filtrarReportesPorEstudiante(codigo);\n}\n\n\n// Calendario\n\nfunction iniciarCalendario() {\n    var calendarEl = document.getElementById('calendar');\n    var calendar = new FullCalendar.Calendar(calendarEl, {\n        initialView: 'dayGridMonth',\n        locale: 'es',\n        events: '/api/reservas'\n    });\n\n    calendar.render();\n}\n\n// Funci√≥n para abrir el modal\nfunction abrirModalReserva() {\n    document.getElementById(\"modalReserva\").style.display = \"block\";\n}\n\n// Funci√≥n para cerrar el modal\nfunction cerrarModalReserva() {\n    document.getElementById(\"modalReserva\").style.display = \"none\";\n}\n\n\n\n\n\n\n// REGISTROS\n\nasync function registrarNovedad(estudiante, reporte){\n\n    const {codigo, nombre, grupoid} = estudiante\n\n    const grupoSeleccionado = document.getElementById(\"grupos\").value;\n    const asignaturaSeleccionada = document.getElementById(\"asignatura\").value;\n\n    // Verificar si se seleccion√≥ un grupo y una asignatura\n    if (!grupoSeleccionado || !asignaturaSeleccionada) {\n        mostrarNotificacion(\"‚ö†Ô∏è Debes seleccionar un grupo y una asignatura antes de registrar.\");\n        return;\n    }\n\n    const datos = new FormData();\n    datos.append('estudiante', nombre)\n    datos.append('codigoid', codigo)\n    datos.append('reporte', reporte)\n    datos.append('grupo', grupoid)\n    datos.append(\"grupo\", grupoSeleccionado);\n    datos.append(\"asignaturaid\", asignaturaSeleccionada);\n\n    // Peticion hacia la API\n    const url = 'http://localhost:3002/api/asistencia'\n\n    const respuesta = await fetch(url, {\n        method: 'POST',\n        body: datos\n    })\n\n    const resultado = await respuesta.json();\n    // console.log(resultado);\n\n    // Volver a cargar los reportes desde la API\n    await consultarReportes();\n\n    // Filtrar nuevamente la tabla seg√∫n el estudiante seleccionado\n    filtrarReportesPorEstudiante(estudiante.codigo);\n\n    mostrarNotificacion(\"Registro Exitoso ‚úÖ\");\n\n    // console.log(\"Novedad registrada y tabla actualizada\");\n}\n\nasync function eliminarReporte(id) {\n    if (!confirm(\"¬øEst√°s seguro de que deseas eliminar este reporte?\")) {\n        return;\n    }\n\n    try {\n        const url = \"http://localhost:3002/api/eliminar-asistencia\"; // Aseg√∫rate de que la ruta sea correcta\n\n        const formData = new FormData();\n        formData.append(\"id\", id);\n\n        const respuesta = await fetch(url, {\n            method: \"POST\",\n            body: formData\n        });\n\n        if (!respuesta.ok) {\n            throw new Error(\"Error al eliminar el reporte\");\n        }\n\n        const resultado = await respuesta.json();\n        console.log(\"Reporte eliminado:\", resultado);\n\n        // Volver a cargar los reportes desde la API\n        await consultarReportes();\n\n        // console.log(\"C√≥digo actual en estudiante_sel:\", estudiante_sel.codigo);\n\n        // Verificar si estudiante_sel.codigo tiene un valor v√°lido antes de filtrar\n        if (estudiante_sel.codigo) {\n            filtrarReportesPorEstudiante(estudiante_sel.codigo);\n        } else {\n            console.warn(\"No hay estudiante seleccionado para filtrar reportes.\");\n        }\n\n        // Mostrar notificaci√≥n\n        mostrarNotificacion(\"Reporte eliminado con √©xito ‚ùå\");\n\n    } catch (error) {\n        console.error(\"Error al eliminar reporte:\", error);\n        mostrarNotificacion(\"Error al eliminar el reporte ‚ùå\");\n    }\n}\n\n\n// Reporte grupo completo\n\n// Funci√≥n para verificar el estado del grupo seleccionado\nfunction verificarEstadoGrupo() {\n    const grupoId = document.getElementById(\"grupos\").value;\n    const botonGrupoCompleto = document.getElementById(\"grupo-completo\");\n\n    // Buscar si el grupo tiene el estado \"completo\" para la fecha actual\n    const grupo = estadoGrupos.find(\n        (g) => g.idgrupo == grupoId && g.completo === \"completo\" && g.fecha === hoy\n    );\n\n    // Deshabilitar o habilitar el bot√≥n seg√∫n el estado del grupo\n    if (grupo) {\n        botonGrupoCompleto.disabled = true;\n        botonGrupoCompleto.classList.add('deshabilitado')\n        alert(`El grupo est√° completo hoy üëçüèª`);\n    } else {\n        botonGrupoCompleto.disabled = false;\n    }\n}\n\n// Escucha el cambio en el selector de grupos\ndocument.getElementById(\"grupos\").addEventListener(\"change\", verificarEstadoGrupo);\n\n// Funci√≥n para marcar un grupo como completo\ndocument.getElementById(\"grupo-completo\").addEventListener(\"click\", async function () {\n    const grupoId = document.getElementById(\"grupos\").value;\n    const fechaActual = new Date().toISOString().split(\"T\")[0]; // Fecha en formato YYYY-MM-DD\n\n    if (!grupoId) {\n        alert(\"Seleccione un grupo\");\n        return;\n    }\n\n    const formData = new FormData();\n    formData.append(\"grupo\", grupoId);\n    formData.append(\"completo\", \"completo\");\n    formData.append(\"fecha\", fechaActual);\n\n    try {\n        const respuesta = await fetch(\"http://localhost:3002/api/grupo-completo\", {\n            method: \"POST\",\n            body: formData,\n        });\n\n        const resultado = await respuesta.json();\n\n        if (resultado.exito) {\n            alert(\"Grupo marcado como completo üëçüèª\");\n            document.getElementById(\"grupo-completo\").disabled = true; // Desactivar el bot√≥n\n            await cargarEstadoGrupos(); // Recargar el estado de los grupos\n        } else {\n            alert(\"Error al actualizar el grupo\");\n        }\n    } catch (error) {\n        console.error(\"Error al marcar grupo completo:\", error);\n    }\n});"]}